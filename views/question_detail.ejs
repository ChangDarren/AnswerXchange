<!DOCTYPE html>
<html>
<%- include('partials/head') %>
  <body>
    <div class="container">
      <%- include('partials/navBar') %>
      <div class="row">
      <div class="col"></div>
      <div class="col-8">
        <h3><%= question.question %></h3>
        <small>Question by <%= question.userName %></small>
        <!-- The user is able to delete the question if it is his
            question -->
        <% if (user) { %>
          <% if (user._id.toString().localeCompare(question.userID) == 0) { %>
            <a href=<%= question.deleteURL %>>
              <div>
                <small>Delete this question</small>
              </div>
            </a>
          <% } %>
        <% } %>
        <hr class="my-4">
        <div class="jumbotron">
          <h3>Replies</h3>
          <% if (locals.answers.length > 0) { %>
            <% for (let answer of answers) { %>
              <div class="my-4 p-2 border border-primary">
                <p>By <%=answer.userName %> answered at <%= answer.date_formatted %></p>
                  <div class= "border rounded view overlay p-2 my-2">
                    <!-- Add the images if there are any -->
                      <% if (answer.img.data) { %>
                        <img src=<%= answer.picture_data %> alt="Error in picture" width="400px"
                            height="400px">
                      <% } %>
                    <p class = "my-4"> <%= answer.answer %> </p>
                    <% if (user && answer.userID.toString().localeCompare(user._id) == 0) { %>
                        <div>
                          <a href =<%= answer.answerUrl%>>Edit this answer</a>
                        </div>
                    <% } %>
                  </div>
              </div>
            <% } %>
          <% } else { %>
            <div class="alert alert-danger p-2" role="alert">
              <p >There are no answers to this question,
                  why don't you give the first reply?</p>
            </div>
          <% } %>
        </div>
        <hr class="my-4">
          <form action="" method="post">
            <div class="form-group">
              <label for="answer">Your answer:</label>
              <%- include('partials/quill-textArea') %>
              <input class="form-control" type="hidden" name="question"
                  required="true" value=question._id>
            </div>
          <button class="btn btn-primary my-2" type="submit">Submit</button>
        </form>
      </div>
      <div class="col"></div>
    </div>
  </body>
<%- include('partials/footer') %>
</html>
